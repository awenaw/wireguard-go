# Windows IoT å¹¶å‘ RDP (æ— æ„Ÿè¿œç¨‹) éƒ¨ç½²æŒ‡å—

> æœ¬æŒ‡å—ç”¨äºåœ¨ Windows IoT/Enterprise è®¾å¤‡ä¸Šå¯ç”¨å¤šç”¨æˆ·è¿œç¨‹æ¡Œé¢å¹¶å‘ä¼šè¯ã€‚
> å¯ç”¨åï¼Œè¿ç»´äººå‘˜å¯è¿œç¨‹è¿æ¥è®¾å¤‡è¿›è¡Œç»´æŠ¤ï¼Œè€Œå®Œå…¨ä¸å½±å“æœ¬åœ°ç”¨æˆ·çš„å±å¹•æ“ä½œï¼ˆä¸ä¼šé»‘å±/é”å±ï¼‰ã€‚

---

## ğŸ“‚ èµ„æºå‡†å¤‡

åœ¨è¿›è¡Œéƒ¨ç½²å‰ï¼Œè¯·ç¡®ä¿æ‚¨æ‹¥æœ‰ä»¥ä¸‹æ–‡ä»¶åŒ…ï¼ˆå·²åœ¨ `wg_config/rdp_files/` ç›®å½•æ•´ç†ï¼‰ï¼š

1. **RDPWInst.exe**: RDP Wrapper å®‰è£…ç¨‹åº (v1.6.2)
2. **rdpwrap.ini**: åŒ…å«æœ€æ–° Windows ç‰ˆæœ¬åç§»é‡çš„é…ç½®æ–‡ä»¶ (æ¨è sebaxakerhtc æº)
3. **install_rdp_wrapper_offline.ps1**: æˆ‘ä»¬ç¼–å†™çš„ä¸€é”®ç¦»çº¿å®‰è£…è„šæœ¬

---

## ğŸš€ éƒ¨ç½²æµç¨‹

### æ–¹æ³•ä¸€ï¼šå…¨è‡ªåŠ¨ PowerShell è„šæœ¬ (æ¨è)

æ­¤æ–¹æ³•é€‚ç”¨äºæ‰¹é‡éƒ¨ç½²ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å¤„ç† Defender ç™½åå•ã€æ–‡ä»¶å¤åˆ¶å’ŒæœåŠ¡é‡å¯ã€‚

1. **ä¸Šä¼ æ–‡ä»¶**
   å°†åŒ…å«ä¸Šè¿°æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°ç›®æ ‡è®¾å¤‡çš„ä»»æ„ç›®å½•ï¼ˆä¾‹å¦‚ `C:\Users\Admin\rdp_install\`ï¼‰ã€‚

2. **æ‰§è¡Œå®‰è£…**
   ä»¥**ç®¡ç†å‘˜æƒé™**è¿è¡Œ PowerShellï¼Œå¹¶æ‰§è¡Œï¼š
   
   ```powershell
   # å…è®¸æ‰§è¡Œè„šæœ¬
   Set-ExecutionPolicy Bypass -Scope Process -Force
   
   # è¿è¡Œå®‰è£…è„šæœ¬
   .\install_rdp_wrapper_offline.ps1
   ```

3. **ç­‰å¾…å®Œæˆ**
   è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
   - æ·»åŠ  `C:\Program Files\RDP Wrapper` åˆ° Defender æ’é™¤åˆ—è¡¨
   - å¤åˆ¶æ–‡ä»¶åˆ°å®‰è£…ç›®å½•
   - å®‰è£…å¹¶å¯åŠ¨ `termservice`
   - é‡å¯æœåŠ¡ä»¥åº”ç”¨é…ç½®

---

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£… (æ’é”™ç”¨)

å¦‚æœè„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨æ“ä½œï¼š

1. **é…ç½® Defender æ’é™¤é¡¹**
   æ‰“å¼€â€œWindows å®‰å…¨ä¸­å¿ƒâ€ -> â€œç—…æ¯’å’Œå¨èƒé˜²æŠ¤â€ -> â€œç®¡ç†è®¾ç½®â€ -> â€œæ’é™¤é¡¹â€ï¼Œæ·»åŠ æ–‡ä»¶å¤¹ `C:\Program Files\RDP Wrapper`ã€‚

2. **å¤åˆ¶æ–‡ä»¶**
   å°† `RDPWInst.exe` å’Œ `rdpwrap.ini` å¤åˆ¶åˆ°ä¸Šè¿°ç›®å½•ã€‚

3. **å®‰è£…æœåŠ¡**
   ä»¥ç®¡ç†å‘˜èº«ä»½åœ¨ CMD è¿è¡Œï¼š
   ```cmd
   cd "C:\Program Files\RDP Wrapper"
   RDPWInst.exe -i
   ```

4. **åº”ç”¨é…ç½®**
   åœæ­¢è¿œç¨‹æ¡Œé¢æœåŠ¡ï¼Œè¦†ç›–æœ€æ–°çš„ `rdpwrap.ini`ï¼Œç„¶åé‡å¯æœåŠ¡ï¼š
   ```cmd
   net stop termservice
   copy /y rdpwrap.ini "C:\Program Files\RDP Wrapper\"
   net start termservice
   ```

5. **é…ç½®æ³¨å†Œè¡¨ (å…è®¸ RDP)**
   ```powershell
   # å¼€å¯ RDP
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
   # å…è®¸å•ç”¨æˆ·å¤šä¼šè¯
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -Name "fSingleSessionPerUser" -Value 0
   ```

---

## âœ… éªŒè¯å®‰è£…

1. **æœ¬åœ°æ£€æŸ¥**
   è¿è¡Œå®‰è£…ç›®å½•ä¸‹çš„ `RDPConf.exe` (å¦‚æœå·²ä¸‹è½½)ï¼Œæ£€æŸ¥çŠ¶æ€ï¼š
   - Wrapper state: **Installed**
   - Service state: **Running**
   - Listener state: **Listening**
   - **[fully supported]** (å…¨ç»¿)

2. **è¿œç¨‹æµ‹è¯•**
   - ä¿æŒç›®æ ‡è®¾å¤‡æœ¬åœ°æœ‰äººç™»å½•ï¼ˆå¯è§å±å¹•ï¼‰ã€‚
   - ä»å¦ä¸€å°ç”µè„‘ä½¿ç”¨ RDP (mstsc) è¿æ¥è¯¥è®¾å¤‡ IPã€‚
   -ä½¿ç”¨**ä¸åŒ**çš„è´¦å·ï¼ˆæ¨èï¼‰æˆ–è€…ç›¸åŒè´¦å·è¿›è¡Œç™»å½•ã€‚
   - **ç»“æœ**ï¼šè¿œç¨‹è¿æ¥æˆåŠŸè¿›å…¥æ¡Œé¢ï¼Œä¸”æœ¬åœ°å±å¹•**æœªé»‘å±**ï¼Œä¸¤è€…äº’ä¸å¹²æ‰°ã€‚

---

## âš ï¸ å¸¸è§é—®é¢˜ä¸ç»´æŠ¤

### 1. Listener state: Not listening?
è¿™é€šå¸¸æ˜¯å› ä¸º `termsrv.dll` ç‰ˆæœ¬è¿‡æ–°ï¼Œè€Œ `rdpwrap.ini` æ²¡æœ‰åŒ…å«å¯¹åº”çš„è¡¥ä¸æ•°æ®ã€‚
- **è§£å†³**ï¼šå» GitHub (stascorp/rdpwrap issues æˆ– sebaxakerhtc) æ‰¾æœ€æ–°çš„ ini æ–‡ä»¶è¦†ç›–å¹¶é‡å¯æœåŠ¡ã€‚

### 2. Windows Update åå¤±æ•ˆï¼Ÿ
Windows æ›´æ–°å¯èƒ½ä¼šæ›¿æ¢ `termsrv.dll`ï¼Œå¯¼è‡´ RDP Wrapper å¤±æ•ˆã€‚
- **ç­–ç•¥**ï¼šåœ¨ WireGuard çš„è¿ç»´è„šæœ¬ä¸­åŠ å…¥å®šæœŸæ£€æŸ¥é€»è¾‘ï¼Œå¦‚æœå‘ç° Listener æŒ‚äº†ï¼Œè‡ªåŠ¨æ‹‰å–æœ€æ–°çš„ ini æ–‡ä»¶å¹¶é‡å¯ã€‚

### 3. Defender è¯¯æŠ¥ï¼Ÿ
RDP Wrapper ä¿®æ”¹å†…å­˜çš„è¡Œä¸ºä¼šè¢«æ€æ¯’è½¯ä»¶è§†ä¸ºå¨èƒã€‚
- **è§£å†³**ï¼šç¡®ä¿å®‰è£…ç›®å½•æ°¸è¿œåœ¨ Defender çš„**æ’é™¤åˆ—è¡¨**ä¸­ã€‚

---

## ğŸ“ è„šæœ¬æºç å‚è€ƒ

### win_rdp_setup_v2.ps1 (ç¯å¢ƒé¢„æ£€)
ä½ç½®ï¼š`wg_config/win_rdp_setup_v2.ps1`
ä½œç”¨ï¼šä»…å¼€å¯ RDP å¼€å…³å’Œé˜²ç«å¢™ï¼Œä¸å®‰è£… Wrapperã€‚

### install_rdp_wrapper_offline.ps1 (ä¸€é”®å®‰è£…)
ä½ç½®ï¼š`wg_config/install_rdp_wrapper_offline.ps1`
ä½œç”¨ï¼šå®Œæ•´çš„å®‰è£…æµç¨‹ã€‚

---
*Generated by Antigravity for IoT Maintenance Workflow*
